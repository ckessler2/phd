alpha = -pi/2:0.01:0;
x = alpha;
figure

Falpha2 = ((1 - tanh((abs(alpha) - 0.2443)/0.1047))/2);
% func1 = -(Falpha2*5.18218452125279.*sin((-alpha)) + (1-Falpha2)*0.807506506794260.*sin(2*(-alpha)));
% func1 = Falpha2.*(0.105977518471870 + 4.93681162104530.*sin(((-alpha)).^2)) + (1 - Falpha2).*1.49958010664229.*(sin((-alpha)).^2);
func1 = Falpha2.*(0.238565281050545 - 2.85289007725274.*(-alpha).^2) + (1-Falpha2).*0.368933365279324.*(1-(-alpha)/(pi/2))

func = tanh(x);
func2 = fit(alpha(:),func(:),'poly3','normalize','on');

% options = fitoptions('Method', 'NonlinearLeastSquares','StartPoint',x0,'MaxIter',1000);

% x0 = [1.49782383697537	1.88606967239306	-0.387507703340789	0.635272376445576	3.39084805372897	2.10130126387511	0.0807506470489288	8.04278215734502	1.15784818532760	0.0253568502989838	10.3796625004074	2.34186036263535	0.00938859642833071	15.6476597074808	2.81600130454164	0.0115213470032810	19.1726919745152	3.02846549925843	0.00836326943708138	23.2039282985524	2.59900314379281	0.00521470935215992	27.1858911010191	2.27056746779923]; 
% fitfun = fittype( @(a,b,c,x) (1-((abs(x) - 0.2443)/0.1047).*(b+((abs(x) - 0.2443)/0.1047))./(c +a*(((abs(x) - 0.2443)/0.1047).^2)))/2 );
% fitfun = fittype( @(a0,a1,a2,a3,a4,a5,a6,a7,a8,b1,b2,b3,b4,b5,b6,b7,b8,c1,c2,c3,c4,c5,c6,c7,c8,x) a0 + a1*sin(b1*x+c1) + a2*sin(b2*x+c2) + a3*sin(b3*x+c3) + a4*sin(b4*x+c4) + a5*sin(b5*x+c5) + a6*sin(b6*x+c6) + a7*sin(b7*x+c7) + a8*sin(b8*x+c8));
[fitted_curve,gof] = fit(x(:),func1(:),"fourier6");

plot(alpha,func1)
hold on
% plot(fitted_curve,'r')

% fit2 = (1-((abs(alpha) - 0.2443)/0.1047).*(6778+((abs(alpha) - 0.2443)/0.1047))./(7505 +1537*(((abs(alpha) - 0.2443)/0.1047).^2)))/2;

% plot(alpha,fit2)
% legend("real","weibull")

% 
% C_Lalpha =  0.91*sin(2.115*x) + 0.1612*sin(8.752*x) + 0.09194*sin(11.71*x) + 0.1887*sin(5.73*x) + 0.02936 *sin(14.58*x);
% plot(alpha,C_Lalpha)

% C_Dalpha = -125.8783 + 9.6401*cos(x*1.8789) - 230.5762*sin(x*1.8789) + 173.0141*cos(2*x*1.8789) + 15.2340*sin(2*x*1.8789) -13.4114*cos(3*x*1.8789) + 105.6618*sin(3*x*1.8789) - 51.1826*cos(4*x*1.8789) - 8.1529*sin(4*x*1.8789) + 3.3431*cos(5*x*1.8789) - 18.7275*sin(5*x*1.8789) + 4.6614*cos(6*x*1.8789) + 0.8163*sin(6*x*1.8789) - 0.0841*cos(7*x*1.8789) + 0.5972 *sin(7*x*1.8789);
% plot(alpha,C_Dalpha)

epsilon_alpha = 0.1465   + 0.0052414*cos(x*3.3371384839) + -0.104177*sin(x*3.3371384839) + 0.0197930*cos(2*x*3.3371384839) + -0.0165049*sin(2*x*3.3371384839) + 0.026364*cos(3*x*3.3371384839) + 0.00433539*sin(3*x*3.3371384839) + 0.02168*cos(4*x*3.3371384839) + 0.00502389*sin(4*x*3.3371384839) + 0.012060267*cos(5*x*3.3371384839) + 0.00185939*sin(5*x*3.3371384839) +   0.004075*cos(6*x*3.3371384839);
plot(alpha,epsilon_alpha)